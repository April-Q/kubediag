# 关于 Go Profiler

当服务在其工作环境中运行时，持续剖析服务的性能可以帮助探究 CPU 周期和内存等资源用在了何处。Go Profiler 是一个低开销的统计性能剖析器，可从生产应用中持续收集有关 CPU 使用率和内存分配情况的信息。它会帮助用户识别应用中资源耗用量最大的部分，还可以阐明应用的性能特征。

配置 Go Profiler 应用以生成性能剖析数据是一个简单的一次性过程：通过附带的性能剖析代理来关联你的服务。创建 Abnormal 后，性能剖析代理会定期运行以收集性能数据，然后将这些数据暴露于一个本地端口。

## 可用的性能剖析类型

* CPU 时间：CPU 执行代码块所花费的时间。
* 堆：程序的堆中在单个时间点上所分配的内存量。
* 线程：创建线程的应用可能会遭遇阻塞的线程（创建后从未实际运行的线程）以及线程泄露（创建的线程数量不断增加）。

## 性能剖析代理

你可以在应用中安装该代理，该代理是一个在运行应用时对应用性能进行数据采集的采集器。

## 性能剖析文件收集

Go Profiler 从应用捕获性能剖析数据，并保存在本地。每个性能剖析文件可供应用的单个实例使用，性能剖析文件中包含四个唯一标识其部署的字段：

* Go Profiler 的 `metadata.name`。
* Go Profiler 的 `metadata.namespace`。
* Go Profiler 的 `spec.profilers[i].name`。
* Go Profiler 的 `spec.profilers[i].type`。

对于用户创建的每一个不同性能剖析类型、指定在不同节点上的 Go Profiler，后端会即时选择一个 Kube Diagnoser Agent，并指示其捕获一个性能剖析文件。

* 堆用量和线程性能剖析文件是即时收集的
* CPU 时间性能剖析文件表示30s内的收集数据

## Profiler 剖析数据查看

在收集了性能剖析数据之后，你可以使用浏览器界面查看关于 CPU 和内存使用情况的统计信息与应用的各部分有何关联，以及通过火焰图分析你的应用。
